{"id":"745a3aa9-ac86-4612-9a0f-62a43b98cbe3","rev":1,"v":"1","name":"Sophos XG Dashboard","summary":"A basic graylog dashboard displaying Sophos XG log data","description":"","vendor":"Jeff Singleton (@HackDefendr)","url":"https://github.com/hackdefendr/SophosXG_Graylog","created_at":"2020-05-26T16:24:30.744Z","server_version":"3.3.0+4ea5649","parameters":[],"entities":[{"id":"646c936b-c838-42c5-a30b-5faa83df0c17","type":{"name":"dashboard","version":"2"},"v":"1","data":{"summary":{"@type":"string","@value":"Syslog from a Sophos XG Firewall to Graylog"},"search":{"queries":[{"id":"20b49579-1f4d-4493-8554-8e6cabc9367b","timerange":{"type":"relative","range":300},"query":{"type":"elasticsearch","query_string":""},"search_types":[{"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"name":"chart","timerange":{"type":"relative","range":86400},"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"series":[{"type":"count","id":"Message Count","field":null}],"filter":null,"rollup":true,"row_groups":[],"type":"pivot","id":"23d3f6e6-832d-4079-a794-9507498c787a","column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":""},"name":"chart","timerange":{"type":"relative","range":86400},"streams":[],"series":[{"type":"count","id":"count()","field":null}],"filter":null,"rollup":true,"row_groups":[{"type":"values","field":"category","limit":15}],"type":"pivot","id":"bc7ed6bc-3e71-41db-b589-826bb97239c9","column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"name":"chart","timerange":{"type":"relative","range":86400},"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"series":[{"type":"count","id":"count()","field":null}],"filter":null,"rollup":true,"row_groups":[{"type":"values","field":"src_ip_geolocation","limit":15}],"type":"pivot","id":"73530461-b5f4-4fda-a9b5-c866aa5cbe8f","column_groups":[],"sort":[]},{"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"name":null,"timerange":{"type":"relative","range":86400},"offset":0,"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"filter":null,"decorators":[{"id":"5ecc355dcb6890d9f8e385dd","type":"org.graylog2.decorators.FormatStringDecorator","config":{"format_string":"${source} - ${message}","require_all_fields":false,"target_field":"message"},"stream":null,"order":0}],"type":"messages","id":"d3045ae1-d4bb-4819-87c4-8188c2f919f7","limit":150}]}],"parameters":[],"requires":{},"owner":"admin","created_at":"2020-05-25T23:19:47.032Z"},"created_at":"2020-05-25T20:55:23.770Z","requires":{},"state":{"20b49579-1f4d-4493-8554-8e6cabc9367b":{"selected_fields":null,"static_message_list_id":null,"titles":{"tab":{"title":"Sophos XG"},"widget":{"f01768a4-3a01-4237-b9fc-3e7cb0b2c1ff":"Sophos XG Messages","79b78e03-cdf7-4d44-aa23-1988270bf1e7":"Aggregating count() by category"}},"widgets":[{"id":"52ca40cb-873f-431d-bd4f-20182e233aaa","type":"aggregation","filter":null,"timerange":{"type":"relative","range":86400},"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"config":{"visualization":"map","event_annotation":false,"row_pivots":[{"field":"src_ip_geolocation","type":"values","config":{"limit":15}}],"series":[{"config":{"name":null},"function":"count()"}],"rollup":true,"column_pivots":[],"visualization_config":{"viewport":{"zoom":2,"center_x":0,"center_y":0}},"formatting_settings":null,"sort":[]}},{"id":"79b78e03-cdf7-4d44-aa23-1988270bf1e7","type":"aggregation","filter":null,"timerange":{"type":"relative","range":86400},"query":{"type":"elasticsearch","query_string":""},"streams":[],"config":{"visualization":"pie","event_annotation":false,"row_pivots":[{"field":"category","type":"values","config":{"limit":15}}],"series":[{"config":{"name":null},"function":"count()"}],"rollup":true,"column_pivots":[],"visualization_config":null,"formatting_settings":null,"sort":[]}},{"id":"f01768a4-3a01-4237-b9fc-3e7cb0b2c1ff","type":"messages","filter":null,"timerange":{"type":"relative","range":86400},"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"config":{"fields":["timestamp","source","src_ip","dst_port","src_ip_city_name","src_ip_country_code"],"show_message_row":false,"decorators":[{"id":"5ecc355dcb6890d9f8e385dd","type":"org.graylog2.decorators.FormatStringDecorator","config":{"format_string":"${source} - ${message}","require_all_fields":false,"target_field":"message"},"stream":null,"order":0}],"sort":[{"type":"pivot","field":"timestamp","direction":"Descending"}]}},{"id":"8e609dc5-f302-4c7c-a52c-d690cdafeb37","type":"aggregation","filter":null,"timerange":{"type":"relative","range":86400},"query":{"type":"elasticsearch","query_string":"!src_ip:10.71.1.* AND !src_ip:0.0.0.0"},"streams":["70d0a445-4c88-4a4f-b53f-4f956337bfb7"],"config":{"visualization":"numeric","event_annotation":false,"row_pivots":[],"series":[{"config":{"name":"Message Count"},"function":"count()"}],"rollup":true,"column_pivots":[],"visualization_config":null,"formatting_settings":null,"sort":[]}}],"widget_mapping":{"f01768a4-3a01-4237-b9fc-3e7cb0b2c1ff":["d3045ae1-d4bb-4819-87c4-8188c2f919f7"],"52ca40cb-873f-431d-bd4f-20182e233aaa":["73530461-b5f4-4fda-a9b5-c866aa5cbe8f"],"8e609dc5-f302-4c7c-a52c-d690cdafeb37":["23d3f6e6-832d-4079-a794-9507498c787a"],"79b78e03-cdf7-4d44-aa23-1988270bf1e7":["bc7ed6bc-3e71-41db-b589-826bb97239c9"]},"positions":{"8e609dc5-f302-4c7c-a52c-d690cdafeb37":{"col":9,"row":1,"height":4,"width":4},"79b78e03-cdf7-4d44-aa23-1988270bf1e7":{"col":1,"row":1,"height":4,"width":8},"f01768a4-3a01-4237-b9fc-3e7cb0b2c1ff":{"col":1,"row":11,"height":5,"width":"Infinity"},"52ca40cb-873f-431d-bd4f-20182e233aaa":{"col":1,"row":5,"height":6,"width":"Infinity"}},"formatting":{"highlighting":[]},"display_mode_settings":{"positions":{}}}},"properties":[],"owner":"admin","title":{"@type":"string","@value":"Sophos XG Firewall"},"type":"DASHBOARD","description":{"@type":"string","@value":"This is a basic dashboard for displaying log data sent via Syslog from a Sophos XG Firewall to a Graylog instance."}},"constraints":[{"type":"server-version","version":">=3.3.0+4ea5649"}]},{"id":"70d0a445-4c88-4a4f-b53f-4f956337bfb7","type":{"name":"stream","version":"1"},"v":"1","data":{"alarm_callbacks":[],"outputs":[],"remove_matches":{"@type":"boolean","@value":true},"title":{"@type":"string","@value":"Sophos XG Firewall"},"stream_rules":[{"type":{"@type":"string","@value":"PRESENCE"},"field":{"@type":"string","@value":"src_ip"},"value":{"@type":"string","@value":""},"inverted":{"@type":"boolean","@value":false},"description":{"@type":"string","@value":"src_ip fields must be present"}},{"type":{"@type":"string","@value":"EXACT"},"field":{"@type":"string","@value":"log_type"},"value":{"@type":"string","@value":"Firewall"},"inverted":{"@type":"boolean","@value":false},"description":{"@type":"string","@value":""}}],"alert_conditions":[],"matching_type":{"@type":"string","@value":"AND"},"disabled":{"@type":"boolean","@value":false},"description":{"@type":"string","@value":"Log Type Firewall"},"default_stream":{"@type":"boolean","@value":false}},"constraints":[{"type":"server-version","version":">=3.3.0+4ea5649"}]}]}